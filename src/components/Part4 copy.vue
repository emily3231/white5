<script setup>
import { ref, computed } from 'vue'

// ä¸‰å€‹ä¸»é¡Œï¼ˆå«åœ–ç‰‡ã€æ¨™é¡Œã€æ–‡å­—ã€ç¥ç¦èªï¼‰
const treasures = [
  {
    id: 1,
    label: 'èº«é«”å¥åº·',
    closed: 'https://picsum.photos/id/1011/200/150',
    opened: 'https://picsum.photos/id/1015/200/150',
    wish: 'æˆ‘çš„æ–°å¹´æ–°é¡˜æ˜¯... èº«é«”å¥åº·',
    title: 'å¥åº· Fitbackï¼',
    text: 'ä½ å¥åº·ä¸é›£ï¼Œé›£çš„æ˜¯ä½ ä¸å‹•ï½Fitä¸€ä¸‹ï¼Œå›é¥‹é¦¬ä¸Šä¾†ï¼',
    blessings: [
      'æŠŠæ¯ä¸€æ­¥éƒ½èµ°æˆç¥ç¦ï¼Œèµ°æˆå¥½é«”åŠ›',
      'ç²¾ç¥æ»¿æ»¿ æ´»åŠ›æ—º',
      'å¥åº·æ˜¯æœ€å¥½çš„ç¦®ç‰©ï¼Œé¡˜å®ƒæ°¸é ä¼´éš¨ä½ ',
      'å¹³å®‰å–œæ¨‚ å¥åº·å¼·',
      'å¥åº·å¦‚åŒå …å›ºçš„ç›¾ç‰Œï¼Œå®ˆè­·ä½ é é›¢é¢¨é›¨',
    ],
  },
  {
    id: 2,
    label: 'ç’°éŠä¸–ç•Œ',
    closed: 'https://picsum.photos/id/1011/200/150',
    opened: 'https://picsum.photos/id/1039/200/150',
    wish: 'æˆ‘çš„æ–°å¹´æ–°é¡˜æ˜¯... ç’°éŠä¸–ç•Œ',
    title: 'ç¶²è·¯æŠ•ä¿ï¼',
    text: 'æ—…ç¨‹ç²¾å½©ï¼Œè¨ˆç•«å‘¨å…¨æ›´å®‰å¿ƒï½è¡æ™¯é»çš„åŒæ™‚ï¼Œä¹Ÿè¨˜å¾—å¹«è‡ªå·±å¤šä¸€å±¤æº–å‚™ï¼',
    blessings: [
      'æŠŠæ¢ç´¢ä¸–ç•Œçš„å‹‡æ°£ï¼Œç•¶æˆæœ€ç¾çš„ç¥ç¦',
      'çœ¼ç•Œå¯¬å»£ å¿ƒæ­¡æš¢',
      'ä¸–ç•Œå¾ˆå¤§ï¼Œæ¯ä¸€æ­¥éƒ½æ˜¯æ–°çš„å†’éšª',
      'æ­¥æ­¥é«˜å‡ è¡Œè¬é‡Œ',
      'é¡˜ä¸–ç•Œçš„ç¾éº—ï¼Œæˆç‚ºä½ äººç”Ÿçš„é¤Šåˆ†',
    ],
  },
  {
    id: 3,
    label: 'å®‰å¿ƒå®ˆè­·',
    closed: 'https://picsum.photos/id/1011/200/150',
    opened: 'https://picsum.photos/id/1050/200/150',
    wish: 'æˆ‘çš„æ–°å¹´æ–°é¡˜æ˜¯... å®‰å¿ƒå®ˆè­·',
    title: 'ä¿éšªè¦–åœ–',
    text: 'å¤šä¸€é»æº–å‚™ï¼Œå°±èƒ½å¤šä¸€é»å®‰å¿ƒï¼Œè®“æ¯ä¸€æ­¥éƒ½èµ°å¾—æ›´ç©©ã€‚',
    blessings: [
      'å¹³å®‰ä¸æ‰“çƒŠï¼Œå®ˆè­·å…¨å¹´ç„¡ä¼‘',
      'å®¶å’Œè¬äº‹ å¹³å®‰åˆ°',
      'é¡˜ä½ èº«é‚Šç¸½æœ‰æº«æš–çš„å®ˆè­·ï¼Œå¦‚åŒå …å¯¦å¾Œç›¾',
      'å®ˆè­·ç›¸éš¨ ç„¡æ‰€æ‡¼',
      'é¡˜ä½ çš„äººç”Ÿç„¡è«–é¢¨é›¨ï¼Œéƒ½æœ‰ä¿éšœç›¸éš¨',
    ],
  },
]

// ç•¶å‰é¸æ“‡çš„ä¸»é¡Œ
const selectedId = ref(null)

// ç›®å‰é¸ä¸­çš„ä¸»é¡Œ
const currentTreasure = computed(() =>
  treasures.find(t => t.id === selectedId.value)
)

// é»æ“Šåˆ‡æ›ä¸»é¡Œ
function selectTreasure(id) {
  selectedId.value = id === selectedId.value ? null : id
}

// æ¨¡æ“¬ã€Œå„²å­˜æˆªåœ–ã€
function saveScreenshot() {
  alert('ğŸ“¸ å·²å„²å­˜æˆªåœ–ï¼ï¼ˆå¯æ•´åˆ html2canvasï¼‰')
}

// æ¨¡æ“¬ã€Œåˆ†äº«åŠŸèƒ½ã€
function shareResult() {
  alert('ğŸ“¤ å·²åˆ†äº«è‡³ FB / IGï¼ï¼ˆå¯æ•´åˆåˆ†äº« APIï¼‰')
}
</script>

<template>
  <div class="wrap">
    <!-- ä¸Šæ–¹ä¸‰å€‹ä¸»é¡Œ -->
    <div class="treasure-list">
      <div
        v-for="t in treasures"
        :key="t.id"
        class="treasure-item"
      >
        <img
          :src="selectedId === t.id ? t.opened : t.closed"
          :alt="t.label"
          class="treasure-img"
          @click="selectTreasure(t.id)"
        />

        <button
          class="btn"
          :class="{ active: selectedId === t.id }"
          @click="selectTreasure(t.id)"
        >
          {{ selectedId === t.id ? 'å·²æ‰“é–‹ï¼š' + t.label : 'æ‰“é–‹ ' + t.label }}
        </button>
      </div>
    </div>

    <!-- ä¸‹æ–¹å…§å®¹ -->
    <transition name="fade" mode="out-in">
      <div v-if="currentTreasure" class="text-box fade-in">
        <!-- å°è©±æ¡† 1ï¼šé¡˜æœ› -->
        <div class="bubble bubble-left">
          <p>{{ currentTreasure.wish }}</p>
        </div>

        <!-- å°è©±æ¡† 2ï¼šä¸»é¡Œå…§å®¹ -->
        <div class="bubble bubble-right">
          <h3>{{ currentTreasure.title }}</h3>
          <p>{{ currentTreasure.text }}</p>
        </div>

        <!-- ä¸‹æ‹‰é¸å–® -->
        <h4 class="dropdown-title">é¸ä¸€å€‹ç¥ç¦å§ ğŸ’«</h4>
        <select class="dropdown">
          <option v-for="(b, i) in currentTreasure.blessings" :key="i">
            {{ b }}
          </option>
        </select>

        <!-- å…©é¡†æŒ‰éˆ• -->
        <div class="bottom-btns">
          <button class="action-btn" @click="saveScreenshot">ğŸ“¸ å„²å­˜æˆªåœ–</button>
          <button class="action-btn" @click="shareResult">ğŸ“¤ åˆ†äº«çµæœ</button>
        </div>
      </div>
    </transition>
  </div>
</template>

<style scoped>
.wrap {
  max-width: 900px;
  margin: 0 auto;
  padding: 20px;
  text-align: center;
}

.treasure-list {
  display: flex;
  justify-content: center;
  gap: 40px;
  flex-wrap: wrap;
  margin-bottom: 30px;
}

.treasure-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
}

.treasure-img {
  width: 200px;
  height: 150px;
  border-radius: 10px;
  object-fit: cover;
  border: 2px solid #ccc;
  cursor: pointer;
  transition: transform 0.3s, border-color 0.3s;
}

.treasure-img:hover {
  transform: scale(1.05);
  border-color: #3b82f6;
}

.btn {
  padding: 10px 20px;
  border-radius: 999px;
  border: 1px solid #ccc;
  background: white;
  cursor: pointer;
  font-size: 14px;
  transition: background 0.2s, color 0.2s, border-color 0.2s;
}
.btn:hover {
  background: #f3f4f6;
}
.btn.active {
  background: #3b82f6;
  color: white;
  border-color: #3b82f6;
}

.text-box {
  max-width: 600px;
  margin: 0 auto;
  background: #f8fafc;
  border-radius: 10px;
  padding: 20px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}

/* å°è©±æ¡†æ¨£å¼ */
.bubble {
  position: relative;
  display: inline-block;
  padding: 15px 20px;
  border-radius: 20px;
  margin: 10px 0;
  max-width: 80%;
  text-align: left;
  line-height: 1.5;
}
.bubble-left {
  background: #e0f2fe;
  align-self: flex-start;
}
.bubble-right {
  background: #dbeafe;
  align-self: flex-end;
}
.bubble-left::after {
  content: '';
  position: absolute;
  left: -8px;
  top: 15px;
  border: 8px solid transparent;
  border-right-color: #e0f2fe;
}
.bubble-right::after {
  content: '';
  position: absolute;
  right: -8px;
  top: 15px;
  border: 8px solid transparent;
  border-left-color: #dbeafe;
}

.dropdown-title {
  font-weight: bold;
  color: #1e3a8a;
  margin-top: 15px;
}

.dropdown {
  width: 100%;
  padding: 10px;
  border-radius: 8px;
  border: 1px solid #ccc;
  margin: 10px 0 20px;
}

/* å…©é¡†åº•éƒ¨æŒ‰éˆ• */
.bottom-btns {
  display: flex;
  justify-content: center;
  gap: 20px;
}
.action-btn {
  padding: 10px 20px;
  border-radius: 25px;
  border: none;
  background: #2563eb;
  color: #fff;
  cursor: pointer;
  font-size: 15px;
  transition: 0.2s;
}
.action-btn:hover {
  background: #1e40af;
}

/* å‹•ç•« */
.fade-in {
  animation: fadeIn 0.4s ease-in-out;
}
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}
</style>
